---
import HomeIcon from "/home.svg?raw";
import ComponentIcon from "/component.svg?raw";
import LayoutIcon from "/theme.svg?raw";
import SearchIcon from "/search.svg?raw";

import SidebarItem from "./SidebarItem.astro";
import DrawerItems from "./DrawerItems.astro";

import { getCollection } from "astro:content";
import ThemeToggler from "./ThemeToggler.astro";

//@ts-ignore
const allComponents = await getCollection("assets");
const components = allComponents.map((e) => e.data.title);

const allLayouts = await getCollection("layouts");
const layouts = allLayouts.map((e) => e.data.title);
---

<header class="">
  <div
    id="sidebar"
    class="fixed -start-24 flex flex-col justify-between items-center md:top-0 md:start-0 peer overflow-auto h-full z-50 bg-slate-100 dark:bg-gray-800"
  >
    <nav
      aria-label="navigation-rail"
      class="relative w-[88px] flex flex-col gap-4"
    >
      <SidebarItem svgPath={HomeIcon} title="Home" url="/" />
      <SidebarItem
        svgPath={ComponentIcon}
        title="Components"
        url="/Components"
      />
      <SidebarItem svgPath={LayoutIcon} title="Layouts" url="/Layouts" />
      <SidebarItem svgPath={SearchIcon} title="Search" url="/Search" />
    </nav>
    <ThemeToggler />
  </div>
  <aside
    aria-label="navigation-drawer"
    class="w-[230px] border-l-2 border-gray-400 dark:border-white top-0 bottom-0 fixed -translate-x-[calc(230px+88px)] hover:translate-x-[88px] peer-hover:translate-x-[88px] transition-transform ease-linear duration-300 rounded-tr-2xl rounded-br-2xl bg-slate-100 dark:bg-gray-800 h-full z-40"
  >
    <div aria-label="navigation-drawer-items" class="mt-3">
      <DrawerItems title="home" items={["About"]} page="./" />
      <DrawerItems title="components" items={components} page="/Components" />
      <DrawerItems title="layouts" items={layouts} page="/Layouts" />
    </div>
  </aside>
</header>

<script>
  import $ from "jquery";
  $(document).ready(function () {
    // Show the first drawer item by default
    var defaultItem = $(".sidebar-item:first");
    var defaultId = defaultItem.data("sidebaritemhover");
    $("#" + defaultId + "-drawer-items").fadeIn(300);

    // Hide all other drawer items by default
    $(".drawer-items")
      .not("#" + defaultId + "-drawer-items")
      .hide();

    $("#sidebar").on("mouseenter", ".sidebar-item", function () {
      var id = $(this).data("sidebaritemhover");
      console.log(id);
      $("#" + id + "-drawer-items").fadeIn(300);
      $(".drawer-items")
        .not("#" + id + "-drawer-items")
        .hide();
    });
  });
</script>
